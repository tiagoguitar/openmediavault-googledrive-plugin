version: "1.0"
type: component
data:
  name: "omv-services-googledrive-page"
  type: "tabsPage"
  config:
    tabs:
      - text: "Settings"
        component: "omv-services-googledrive-settings-tab"
      - text: "Files"
        component: "omv-services-googledrive-files-tab"
---
version: "1.0"
type: component
data:
  name: "omv-services-googledrive-settings-tab"
  type: "formPage"
  config:
    request:
      service: "GoogleDrive"
      get:
        method: "isAuthenticated"
    fields:
      - type: "container"
        fields:
          - type: "paragraph"
            text: "Configure your Google Drive integration settings."
          - type: "button"
            name: "authenticate"
            text: "Authenticate with Google Drive"
            request:
              service: "GoogleDrive"
              method: "getAuthUrl"
              progressMessage: "Getting authentication URL..."
              successNotification: "Please follow the authentication URL to authorize the application."
          - type: "textInput"
            name: "authCode"
            label: "Authorization Code"
            hint: "Enter the authorization code from Google after authentication."
          - type: "button"
            name: "setAuthCode"
            text: "Set Authorization Code"
            request:
              service: "GoogleDrive"
              method: "setAuthCode"
              params:
                authCode: "{{ authCode }}"
              progressMessage: "Setting authorization code..."
              successNotification: "Authorization code set successfully."
---
version: "1.0"
type: component
data:
  name: "omv-services-googledrive-files-tab"
  type: "datatable"
  config:
    autoReload: true
    hasSearchField: true
    hasHeader: true
    selectionType: "single"
    columns:
      - name: "name"
        text: "Name"
        sortable: true
        flexGrow: 1
      - name: "mimeType"
        text: "Type"
        sortable: true
        flexGrow: 1
      - name: "size"
        text: "Size"
        sortable: true
        cellTemplateName: "binaryUnit"
        flexGrow: 1
      - name: "modifiedTime"
        text: "Modified"
        sortable: true
        cellTemplateName: "localeDateTime"
        flexGrow: 1
    store:
      proxy:
        service: "GoogleDrive"
        get:
          method: "listFiles"
    actions:
      - type: "iconButton"
        icon: "download"
        tooltip: "Download"
        execute:
          type: "request"
          request:
            service: "GoogleDrive"
            method: "downloadFile"
            params:
              fileId: "{{ _selected[0].id }}"
              outputPath: "/tmp/{{ _selected[0].name }}"
            progressMessage: "Downloading file..."
            successNotification: "File downloaded successfully."
      - type: "iconButton"
        icon: "delete"
        tooltip: "Delete"
        execute:
          type: "request"
          request:
            service: "GoogleDrive"
            method: "deleteFile"
            params:
              fileId: "{{ _selected[0].id }}"
            progressMessage: "Deleting file..."
            successNotification: "File deleted successfully."

